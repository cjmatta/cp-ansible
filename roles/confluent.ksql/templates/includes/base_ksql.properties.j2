{% set schema_registries = groups.get('schema-registry', []) %}

{% if security_mode == "ccloud" %}
bootstrap.servers={{ confluent.cloud.broker.endpoint }}
{% else %}
bootstrap.servers={% for host in groups['broker'] %}{% if loop.index > 1%},{% endif %}{{ host }}:{{broker.config.port}}{% endfor %}
{% endif %}

{% if schema_registries and cfg.get('ksql.schema.registry.enable', 'false').lower() == 'true' %}
# Schema Registry
ksql.schema.registry.url={% for host in groups.get('schema-registry', []) -%}
{% set schema_registry_port = hostvars[host].get('schema_registry_listener_port', 8081) %}
{% if loop.index > 1%},{% endif %}
http://{{ host }}:{{ schema_registry_port }}
{%- endfor %}
{% endif %}

{% for key, value in ksql.config.items() %}
{{key}}={{value}}
{% endfor %}